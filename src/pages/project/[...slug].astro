---
import PostLayout from "$src/layouts/PostLayout.astro"

import Header from "$src/components/header/header.jsx"
import Footer from "$src/components/footer.jsx"

import { toLocaleString } from "$src/js/dateUtils.js"
import * as blog from "$src/js/posts.js"

export async function getStaticPaths({ paginate, rss }) {
  const posts = blog.sortedPosts(
    Astro.fetchContent("../../content/project/*.md")
  )
  const pages = posts.map((post) => {
    return {
      params: { slug: post.slug },
      props: { post },
    }
  })

  return pages
}

const { slug } = Astro.request.params
const { post } = Astro.props
---

<PostLayout title={post.title}>
  <div class="wrapper">
    <Header />
    <main>
      <article class="project-post">
        <h2 itemprop="title" class="project-post__title">{post.title}</h2>
        <div class="project-post__metadata">
          <time datetime={post.date}>{toLocaleString(post.date)}</time>
        </div>
        <div set:html={post.astro.html} class="project-post__content">
        </div>
      </article>
    </main>
    <Footer />
  </div>
</PostLayout>
